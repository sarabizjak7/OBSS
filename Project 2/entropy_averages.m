% DATA

% signal 2:
%samp_en = [0.4280	0.5520	0.5870	0.9710	0.6040	0.9000	0.7110	0.6820	0.5440	0.8870	0.8870	0.8790	0.8730	0.8900	1.0480	0.8350	0.6790	0.8980	1.0010	0.8670	1.0560	0.9940	0.9280	0.5410	0.8330	0.8530	0.8130	0.5260	0.7570	0.4920	0.5030	0.8940	0.5960	0.8210	0.8770	0.4800	0.8770	0.8390	0.8700	0.7720	0.7830	0.7380	0.9150	0.6010	0.6440	0.7050	1.0000	0.7210	0.8800	0.9610	0.8380	0.8850	0.7770	0.7770	0.7200	0.6400	0.8700	0.5620	0.9080	0.9260	0.6220	0.8170	0.7590	0.9160	0.9820	0.9870	0.4450	0.9520	0.7910	1.0160	0.8860	1.1160	1.0460	1.1110	1.0440	0.9840	0.6840	0.7130	1.2160	0.7380	1.1110	1.0670	1.0810	0.9970	0.8740	1.1480	1.0920	0.7500	0.7540	0.8350	0.8310	1.1210	0.8560	1.0890	0.9560	0.5760	0.8510	0.9720	1.0030	0.7840	0.7870	0.4600	1.0220	0.6860	1.1640	1.1290	1.0000	0.9530	1.0120	0.8400	0.4850	1.0260	0.9030	0.6830	0.9340	1.0380	1.1330	1.1240	1.1020	0.8590	0.8200	0.9840	1.1040	1.0460	0.8770	0.7530	1.1260	1.0410	0.9120	0.9750	0.9490	0.7430	0.8280	1.0040	0.6090	1.1870	1.0270	0.8980	1.0920	0.9100	1.0070	0.8920	0.8260	0.9340	0.7890	0.7750	0.7140	1.0170	0.8710	1.0660	1.1290	1.1040	0.8240	1.0290	0.9750	1.0440	0.8730	1.0850	0.7010	1.1280	0.9380	0.6380	1.1700	1.0750	1.1040	0.9800	1.0200	0.8920	0.9040	0.8620	1.0050	1.0820	0.8400	1.0890	0.8800	0.5540	1.0620	0.4770	0.7520	0.9740	1.0910	0.5820	1.0790	0.8850	0.8060	0.8690	1.0420	0.9940	0.7130	0.8300	0.7760	0.8330	0.9390	0.6520	0.8560	0.9340	0.8160	1.1390	0.7680	0.6250	0.6610	0.7540	0.6730	0.6330	0.6770	0.4030	0.8750	0.7660	0.5690	0.4880	0.9150	0.7870	0.6440	0.9400	0.8270	0.9090	1.0570	0.8600	1.0160	0.7540	0.3280	0.9610	0.7490	1.0160	0.9820	0.9050	1.1860	0.8910	0.8320	0.8610	0.7990	0.7370	1.0280	0.6090	0.4330	0.9340	0.9050	0.4760	0.7960	0.6610	0.6520	0.8700	0.7310	0.6930	0.7680	0.7360	0.9320	0.4380	0.9840	1.0170	0.6940	0.6620	0.6230	0.9360	0.9820	0.7470	0.3900	0.8100	1.0620	1.1000	0.6910	1.0650	0.7680	0.8000	0.9230	0.9850	0.9390	0.9160	0.8880	0.6310	0.6510	0.6600	0.6800	0.8610	0.6660	0.7140	0.3290	0.7140	0.9250	0.9610	0.6930	0.4760	0.4910	0.6660	0.5640	0.9290	0.9830	1.1420	0.9710	1.0470	0.7550	0.6520	0.8750	0.9560	0.9180	1.0130	0.5230	0.9690	1.0740	0.8940];
%rec_time = [31.29	22.29	31.00	31.29	31.00	22.14	22.86	30.29	22.00	22.14	21.86	22.29	24.43	31.00	22.43	22.57	31.00	22.86	24.43	31.29	23.57	22.71	22.71	23.00	32.00	22.14	31.00	23.00	23.43	30.86	31.29	22.29	23.14	31.57	22.29	30.57	22.71	30.00	31.14	23.86	24.57	24.57	22.57	31.43	24.00	31.29	23.43	30.71	22.43	30.14	30.29	22.14	31.57	22.86	23.14	31.71	24.00	24.43	24.00	31.29	31.43	23.14	31.14	23.14	29.86	23.57	30.57	24.29	31.71	31.29	23.29	22.57	24.29	23.57	30.29	23.29	22.29	30.57	31.43	31.71	22.71	31.14	22.14	25.00	22.86	23.43	30.57	31.29	31.71	22.71	31.29	22.57	31.71	24.43	21.57	30.29	31.43	22.86	23.86	30.29	31.00	30.86	23.14	23.00	21.71	23.00	30.43	22.29	33.00	23.29	32.14	22.71	22.29	22.29	22.29	23.00	23.29	22.14	22.57	30.86	23.43	31.14	24.43	31.71	31.43	23.71	22.71	22.86	24.71	31.57	30.57	31.43	22.57	23.14	23.86	24.00	25.00	23.14	22.86	22.86	23.14	22.57	22.57	22.86	22.86	22.86	22.14	31.00	22.57	24.14	24.14	22.71	31.00	22.57	32.00	30.29	31.14	22.29	31.00	23.14	30.57	22.00	23.43	22.29	23.14	31.00	22.86	23.57	23.29	32.29	30.86	31.00	23.14	22.86	23.86	24.57	22.43	31.57	22.86	30.14	22.00	22.71	32.57	28.00	30.71	29.57	29.00	29.29	33.00	32.43	31.57	31.00	35.57	27.00	33.86	30.00	29.00	30.00	28.00	27.00	31.00	23.14	22.57	31.00	30.71	32.29	31.00	31.14	31.71	30.86	22.00	30.57	22.71	23.29	21.86	23.29	23.29	22.43	33.43	31.71	31.14	22.71	31.86	32.57	23.86	30.86	25.43	22.43	32.14	24.29	30.57	23.57	30.57	31.43	23.71	23.00	30.57	31.71	31.14	22.86	23.43	22.29	22.43	31.57	31.14	30.43	22.43	32.00	31.00	23.00	31.29	31.86	31.14	31.57	23.14	30.71	31.43	24.00	32.00	22.29	22.57	22.43	31.29	23.14	23.57	30.43	24.00	32.00	23.57	24.00	30.86	31.57	23.29	23.86	31.43	22.43	30.71	33.00	23.29	23.57	23.29	31.86	30.71	30.86	30.86	24.43	30.86	22.86	25.29	31.71	22.71	30.29	32.00	24.29	23.14	23.14	30.57	24.00	23.29	31.00];
%premature = [1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	1	0	1	1	0	0	0	1	0	0	0	1	0	0	0	0	0	0	0	1	1	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	1	0	0	0	0	0	0	1	0	1	1	1	0	0	1	0	0	0	1	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	0	0	0	0	0	1	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0];
%early = [0	1	0	0	0	1	1	0	1	1	1	1	1	0	1	1	0	1	1	0	1	1	1	1	0	1	0	1	1	0	0	1	1	0	1	0	1	0	0	1	1	1	1	0	1	0	1	0	1	0	0	1	0	1	1	0	1	1	1	0	0	1	0	1	0	1	0	1	0	0	1	1	1	1	0	1	1	0	0	0	1	0	1	1	1	1	0	0	0	1	0	1	0	1	1	0	0	1	1	0	0	0	1	1	1	1	0	1	0	1	0	1	1	1	1	1	1	1	1	0	1	0	1	0	0	1	1	1	1	0	0	0	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	0	1	1	1	1	0	1	0	0	0	1	0	1	0	1	1	1	1	0	1	1	1	0	0	0	1	1	1	1	1	0	1	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	1	0	1	1	1	1	1	1	0	0	0	1	0	0	1	0	1	1	0	1	0	1	0	0	1	1	0	0	0	1	1	1	1	0	0	0	1	0	0	1	0	0	0	0	1	0	0	1	0	1	1	1	0	1	1	0	1	0	1	1	0	0	1	1	0	1	0	0	1	1	1	0	0	0	0	1	0	1	1	0	1	0	0	1	1	1	0	1	1	0];


% signal 3:
samp_en = [0.7680	0.5430	0.8970	1.0690	1.1150	0.9630	0.8990	0.6720	0.9410	1.0520	0.9680	1.0000	1.0020	0.7640	1.0980	1.0980	0.8840	1.0070	0.9140	1.0030	1.0690	1.0710	0.5790	0.9330	1.0610	0.9740	0.9460	0.9360	1.0790	0.5200	0.9140	0.9890	0.9480	1.0330	1.0100	0.7040	0.8950	1.0360	0.9420	0.8540	1.1310	1.1430	1.1030	0.8450	0.9420	0.9740	1.0960	0.8190	0.9800	1.0160	1.0420	1.0500	0.9120	1.0420	1.0060	0.7660	0.9340	0.4640	1.0030	0.9220	0.9930	0.9580	0.8510	1.0000	1.1420	0.7900	0.9690	1.0040	0.9640	1.0480	0.9740	1.0720	0.9950	0.8080	1.0030	1.0790	0.9070	0.9310	1.0100	0.9980	1.0910	1.0600	0.9710	1.0340	0.9940	1.0430	1.0930	0.9340	1.0260	0.8700	1.0400	1.1920	1.0250	1.1150	0.9590	0.9980	0.6980	0.9760	0.9840	0.9660	0.9200	1.0190	0.9530	1.0340	1.2830	1.0890	1.0770	1.0090	0.9240	0.8180	0.8890	0.9290	1.1220	0.9800	0.9500	1.1150	0.8370	1.1080	1.0610	0.8220	0.7710	0.9100	1.1730	1.0240	1.0090	0.9870	1.0570	0.9470	0.7310	0.8710	1.0030	1.0150	1.0630	1.1320	0.8720	0.8550	1.0460	1.0560	0.8910	1.0330	0.9880	0.9610	1.0330	0.9250	1.0330	0.9340	0.8410	1.1690	0.9780	1.0360	1.0420	1.1150	1.0710	1.1630	0.9990	1.1900	0.8120	0.9370	0.9640	0.9920	1.0070	0.7760	1.2210	1.0160	1.0900	1.0990	1.0670	1.0480	1.0160	0.9070	0.9420	0.9560	1.1230	1.0340	1.0660	1.0440	1.1440	1.0970	1.0640	0.9600	1.1310	0.7870	1.0040	1.0360	1.0390	0.9240	1.0450	1.0510	0.8510	1.0420	1.0440	0.7660	0.9430	0.8750	0.9650	1.0110	0.8060	1.0160	1.1240	1.0240	0.9610	0.6840	0.8870	0.6690	0.7630	0.8120	0.9970	1.0500	1.0170	0.9140	0.9610	0.7570	0.8570	1.1110	0.9870	0.9190	1.0440	0.9190	1.0390	0.7990	0.6290	1.0950	1.0250	1.0340	0.9490	0.9400	1.1870	1.0920	1.0740	1.0720	0.8050	0.9560	0.9590	0.8850	0.7470	0.8470	0.9400	0.8760	1.0100	1.0460	0.9020	0.9900	1.0230	0.9330	1.0520	1.1110	1.0790	0.9930	1.0310	1.0170	0.8310	0.6880	0.7630	0.9810	1.1560	0.9840	0.9230	1.0070	1.0700	1.0880	0.9290	0.9160	1.0360	0.9510	1.0980	0.9870	1.0880	0.9880	1.1390	0.7390	0.7730	1.0640	0.9930	1.0530	1.0790	1.0440	0.7190	0.9390	0.7670	1.1280	0.9110	0.6100	0.7680	0.9060	0.9730	0.9460	1.0110	1.1570	1.0370	1.0660	0.9760	0.7100	0.9690	1.0700	1.0800	1.0080	0.8100	0.9790	1.0780	1.0260];
rec_time = [31.29	22.29	31.00	31.29	31.00	22.14	22.86	30.29	22.00	22.14	21.86	22.29	24.43	31.00	22.43	22.57	31.00	22.86	24.43	31.29	23.57	22.71	22.71	23.00	32.00	22.14	31.00	23.00	23.43	30.86	31.29	22.29	23.14	31.57	22.29	30.57	22.71	30.00	31.14	23.86	24.57	24.57	22.57	31.43	24.00	31.29	23.43	30.71	22.43	30.14	30.29	22.14	31.57	22.86	23.14	31.71	24.00	24.43	24.00	31.29	31.43	23.14	31.14	23.14	29.86	23.57	30.57	24.29	31.71	31.29	23.29	22.57	24.29	23.57	30.29	23.29	22.29	30.57	31.43	31.71	22.71	31.14	22.14	25.00	22.86	23.43	30.57	31.29	31.71	22.71	31.29	22.57	31.71	24.43	21.57	30.29	31.43	22.86	23.86	30.29	31.00	30.86	23.14	23.00	21.71	23.00	30.43	22.29	33.00	23.29	32.14	22.71	22.29	22.29	22.29	23.00	23.29	22.14	22.57	30.86	23.43	31.14	24.43	31.71	31.43	23.71	22.71	22.86	24.71	31.57	30.57	31.43	22.57	23.14	23.86	24.00	25.00	23.14	22.86	22.86	23.14	22.57	22.57	22.86	22.86	22.86	22.14	31.00	22.57	24.14	24.14	22.71	31.00	22.57	32.00	30.29	31.14	22.29	31.00	23.14	30.57	22.00	23.43	22.29	23.14	31.00	22.86	23.57	23.29	32.29	30.86	31.00	23.14	22.86	23.86	24.57	22.43	31.57	22.86	30.14	22.00	22.71	32.57	28.00	30.71	29.57	29.00	29.29	33.00	32.43	31.57	31.00	35.57	27.00	33.86	30.00	29.00	30.00	28.00	27.00	31.00	23.14	22.57	31.00	30.71	32.29	31.00	31.14	31.71	30.86	22.00	30.57	22.71	23.29	21.86	23.29	23.29	22.43	33.43	31.71	31.14	22.71	31.86	32.57	23.86	30.86	25.43	22.43	32.14	24.29	30.57	23.57	30.57	31.43	23.71	23.00	30.57	31.71	31.14	22.86	23.43	22.29	22.43	31.57	31.14	30.43	22.43	32.00	31.00	23.00	31.29	31.86	31.14	31.57	23.14	30.71	31.43	24.00	32.00	22.29	22.57	22.43	31.29	23.14	23.57	30.43	24.00	32.00	23.57	24.00	30.86	31.57	23.29	23.86	31.43	22.43	30.71	33.00	23.29	23.57	23.29	31.86	30.71	30.86	30.86	24.43	30.86	22.86	25.29	31.71	22.71	30.29	32.00	24.29	23.14	23.14	30.57	24.00	23.29	31.00];
premature = [1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	1	0	1	1	0	0	0	1	0	0	0	1	0	0	0	0	0	0	0	1	1	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	1	0	0	0	0	0	0	1	0	1	1	1	0	0	1	0	0	0	1	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	0	0	0	0	0	1	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0];
early = [0	1	0	0	0	1	1	0	1	1	1	1	1	0	1	1	0	1	1	0	1	1	1	1	0	1	0	1	1	0	0	1	1	0	1	0	1	0	0	1	1	1	1	0	1	0	1	0	1	0	0	1	0	1	1	0	1	1	1	0	0	1	0	1	0	1	0	1	0	0	1	1	1	1	0	1	1	0	0	0	1	0	1	1	1	1	0	0	0	1	0	1	0	1	1	0	0	1	1	0	0	0	1	1	1	1	0	1	0	1	0	1	1	1	1	1	1	1	1	0	1	0	1	0	0	1	1	1	1	0	0	0	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	0	1	1	1	1	0	1	0	0	0	1	0	1	0	1	1	1	1	0	1	1	1	0	0	0	1	1	1	1	1	0	1	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	1	0	1	1	1	1	1	1	0	0	0	1	0	0	1	0	1	1	0	1	0	1	0	0	1	1	0	0	0	1	1	1	1	0	0	0	1	0	0	1	0	0	0	0	1	0	0	1	0	1	1	1	0	1	1	0	1	0	1	1	0	0	1	1	0	1	0	0	1	1	1	0	0	0	0	1	0	1	1	0	1	0	0	1	1	1	0	1	1	0];
gestation = [35.00	38.57	38.57	37.14	38.57	38.86	40.29	41.29	39.57	41.00	38.86	39.43	39.57	39.71	38.71	39.57	39.00	39.00	40.14	40.14	41.00	40.57	40.43	40.00	40.43	38.29	38.29	37.00	40.57	38.00	38.00	40.29	38.43	38.57	32.86	38.29	39.29	38.14	41.14	40.71	40.43	39.43	38.29	32.86	36.57	38.43	40.00	41.71	41.71	37.29	39.71	39.71	39.43	39.43	40.29	39.43	39.71	38.00	40.43	40.43	40.29	40.00	40.00	39.14	37.71	40.57	39.86	39.00	39.71	35.86	38.57	39.29	39.29	36.14	41.29	35.86	40.14	40.43	39.71	40.43	38.57	41.00	37.29	41.00	41.14	40.00	39.14	41.43	39.57	39.29	39.43	39.29	39.57	35.57	39.71	40.29	40.57	39.57	40.29	36.57	38.86	36.57	40.00	38.86	40.57	40.00	38.86	39.14	39.71	34.29	39.86	36.71	31.57	40.00	41.43	38.57	36.43	39.71	40.00	38.71	36.29	40.00	40.00	39.14	39.00	38.71	40.43	41.14	29.29	36.71	39.29	39.86	40.43	40.71	34.71	39.71	40.71	41.00	38.57	40.29	38.29	39.29	40.71	38.71	39.71	38.57	40.00	39.86	39.00	35.71	38.00	39.43	39.86	40.57	41.00	39.29	39.29	39.86	37.71	40.43	39.29	37.57	37.43	41.29	38.57	39.29	39.14	38.00	40.00	41.43	37.43	40.29	38.14	39.71	40.71	39.43	40.57	38.29	40.57	40.57	40.86	40.29	40.29	39.00	40.00	34.00	31.00	41.00	41.00	39.00	35.00	40.00	39.00	37.00	41.00	40.00	38.00	30.00	38.00	33.00	33.00	31.00	37.00	37.00	36.43	40.00	40.43	40.14	36.43	39.43	39.43	38.86	40.14	44.00	38.86	40.43	40.14	35.43	40.57	36.71	41.14	39.00	38.71	41.71	31.14	39.43	41.71	38.71	39.86	39.86	40.29	40.57	39.14	38.43	39.86	40.29	39.14	38.86	40.00	39.43	40.14	38.43	38.86	39.71	40.71	40.43	40.43	40.00	36.86	41.14	40.43	40.14	40.00	38.57	40.00	39.71	39.57	36.43	40.43	35.43	40.00	38.86	40.00	40.71	41.00	40.43	39.86	39.86	38.57	40.14	40.71	40.71	39.57	27.71	39.00	37.71	34.71	41.00	38.71	39.86	41.43	40.00	34.29	39.29	39.14	40.14	40.86	40.86	41.29	40.14	37.86	34.71	40.43	39.00	40.29	39.14	39.57	39.43	39.86	37.14];


r1_count = 0;
r2_count = 0;
clear r1;
clear r2;

PE_count = 0;
PL_count = 0;
TE_count = 0;
TL_count = 0;
PE = 0;
PL = 0;
TE = 0;
TL = 0;

for i = 1 : 300
    % term :
    if (premature(i) == 0)
        r1_count = r1_count + 1;
        r1(r1_count, 1) = rec_time(i);
        r1(r1_count, 2) = samp_en(i);
        r1(r1_count, 3) = gestation(i);
        
        if rec_time(i) < 26
            TE_count = TE_count + 1;
            TE = TE + samp_en(i);  
        else
            TL_count = TL_count + 1;
            TL = TL + samp_en(i);
        end
    % pre-term
    else
        r2_count = r2_count + 1;
        r2(r2_count, 1) = rec_time(i);
        r2(r2_count, 2) = samp_en(i);
        r2(r2_count, 3) = gestation(i);
        if rec_time(i) < 26
            PE_count = PE_count + 1;
            PE = PE + samp_en(i);  
        else
            PL_count = PL_count + 1;
            PL = PL + samp_en(i);
        end
    end
end

x = r1(:, 2); % term sample entropies
y = r2(:, 2); % pre-term sample entropies

scatter(r1(:, 1), r1(:, 2)); 
hold on;
scatter(r2(:, 1), r2(:, 2), 'filled');
hold on;
% Gestation:
%plot(26:37, mean(y) * ones(1, 12), 'k');
%plot(37:46, mean(x) * ones(1, 10), 'k');
%xline(37, '--');

plot(20:26, (PE / PE_count) * ones(1, 7), 'k');
plot(20:26, (TE / TE_count) * ones(1, 7), '--k');
plot(26:36, (PL / PL_count) * ones(1, 11), 'k');
plot(26:36, (TL / TL_count) * ones(1, 11), '--k');

xline(26, '--');
legend('Term', 'Pre-term');
xlabel('Record time');
ylabel('Sample entropy');

%legend('Term', 'Pre-term');
%xlabel('Gestation week');
%ylabel('Sample entropy');



fprintf('Mean sample entropy of term records: %f\n', mean(x));
fprintf('Mean sample entropy of pre-term records: %f\n', mean(y));
fprintf('Mean sample entropy of PE records: %f\n', PE / PE_count);
fprintf('Mean sample entropy of PL records: %f\n', PL / PL_count);
fprintf('Mean sample entropy of TE records: %f\n', TE / TE_count);
fprintf('Mean sample entropy of TL records: %f\n', TL / TL_count);


%%% T - TEST

[H P] = ttest2(x, y)
        
    